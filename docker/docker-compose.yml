version: '2.3'

services:

  main:
    image: main
    container_name: main
    working_dir: /main
    build:
      context: ../
      dockerfile: docker/Dockerfile
    volumes:
      - ../:/main
      - /media/enric/enric_hdd/datasets/polyp-data/:/polyp-data:ro
    runtime: nvidia
    shm_size: '12gb'
    command: tail /dev/null -f
  
  synth-polyp:
    image: synth-polyp
    container_name: synth-polyp
    working_dir: /synth-polyp/synth/src
    build:
      context: ../
      dockerfile: docker/Dockerfile.synth
    volumes:
      - ../:/synth-polyp
      - /media/enric/enric_hdd/datasets/places365_standard/:/datasets/places:ro
      - /media/enric/enric_hdd/datasets/dtd/:/datasets/dtd:ro
      - /media/enric/enric_hdd/datasets/polyp-data/:/polyp-data:ro
    command: tail /dev/null -f

  cyclegan:
    image: cyclegan
    container_name: cyclegan
    working_dir: /cyclegan
    build:
      context: ../
      dockerfile: docker/Dockerfile.cyclegan
    volumes:
      - ../:/cyclegan
      - /media/enric/enric_hdd/datasets/polyp-data/:/polyp-data:ro
    runtime: nvidia
    shm_size: '12gb'
    command: tail /dev/null -f